<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Jcache SPI for using Hazelcast as L2C for Hibernate :: Hazelcast Guides</title>
    <link rel="canonical" href="https://hazelcast.org/hazelcast-hibernate-jcache-l2c/v1.0-beta/index.html">
    <meta name="generator" content="Antora 2.3.3">
    <link rel="stylesheet" href="../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../home/index.html"></a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <a href="../../home/index.html" class="navbar-home-button"></a>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <!-- a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Resource A</a>
            <a class="navbar-item" href="#">Resource B</a>
            <a class="navbar-item" href="#">Resource C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="https://hazelcast.org/">hazelcast.org</a>
          </span>
        </div -->
        <a class="navbar-item" href="https://hazelcast.org/">hazelcast.org</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">

<div class="nav-container" data-component="hazelcast-hibernate-jcache-l2c" data-version="v1.0-beta">
  <aside class="nav">
    <div class="panels">
<!--
<div class="nav-panel-explore is-active" data-panel="explore">
  <div class="context">
    <span class="title">Jcache SPI for using Hazelcast as L2C for Hibernate</span>
    <span class="version">v1.0-beta</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title">Getting Started with Embedded Hazelcast on Kubernetes</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../hazelcast-embedded-kubernetes/v1.0-beta/index.html">v1.0-beta</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Getting Started with Hazelcast and Hibernate Second-Level Cache</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../hazelcast-hibernate-springboot/v1.0-beta/index.html">v1.0-beta</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Getting Started with Hazelcast using Micronaut</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../hazelcast-embedded-micronaut/v1.0-beta/index.html">v1.0-beta</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Getting Started with Hazelcast using Microprofile</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../hazelcast-microprofile/v1.0-beta/index.html">v1.0-beta</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Getting Started with Hazelcast using Spring Boot</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../hazelcast-embedded-springboot/v1.0-beta/index.html">v1.0-beta</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Hazelcast Client for Quarkus</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../quarkus-hazelcast-client/v1.0-beta/index.html">v1.0-beta</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Hazelcast Guides</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../home/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Hazelcast with Istio Service Mesh</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../hazelcast-istio/v1.0-beta/index.html">v1.0-beta</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">Jcache SPI for using Hazelcast as L2C for Hibernate</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">v1.0-beta</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Templates</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../templates/v0.1/index.html">v0.1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
 -->
    </div>
  </aside>
</div>
<!--
nav is included to make toc visible only.
It's not visible on the page. It needs to
be removed after toc is made independent
from nav.
-->

<main class="article">
<div class="toolbar" role="navigation">

<button class="nav-toggle"></button>
<!--
<nav class="breadcrumbs" aria-label="breadcrumbs">
</nav>
  <div class="edit-this-page"><a href="https://github.com/hazelcast-guides/hazelcast-hibernate-jcache-l2c/edit/antora/doc/modules/ROOT/pages/index.adoc">Edit this Page</a></div>
  -->
</div>
  <div class="content">
<article class="guide-content">
<h1 class="page">Jcache SPI for using Hazelcast as L2C for Hibernate</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Configuration deatils to use JCache SPI for Hibernate Second Level Cache backed by Hazelcast IMDG.</p>
</div>
<div class="paragraph">
<p>You can find the code samples for entitiy cache, collection cache, and query cache use cases <a href="https://github.com/hazelcast-guides/hazelcast-hibernate-jcache-l2c">here.</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_youll_learn"><a class="anchor" href="#_what_youll_learn"></a>What Youâ€™ll Learn</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You will be able to use Hibernate Second Level Cache using JCache SPI rather than <code>Hazelcast-hibernate</code> plugin.</p>
</div>
<div class="paragraph">
<p>This is an alternative approach of using <a href="https://github.com/hazelcast/hazelcast-hibernate">Hazelcast-hibernate</a> plugin to use Hazelcast as the caching provider for Hibernate. Note that the local region caches supported by the plugin are not available here. Unlike plugin - which stores query results locally, this approach supports query results to be stored in distributed map.</p>
</div>
<div class="sect2">
<h3 id="_about_jcache"><a class="anchor" href="#_about_jcache"></a>About Jcache</h3>
<div class="paragraph">
<p><a href="https://www.javadoc.io/doc/javax.cache/cache-api/1.1.1">JCache (JSR 107)</a> is a standard caching API for Java.
It provides an API for applications to be able to create and work with in-memory cache of objects. Hibernate has
started to support Jcache implementations for L2C with version 5.2. Using only a CachingProvider implementation,
L2C can be used for SessionFactory objects in Hibernate.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_prerequisites"><a class="anchor" href="#_prerequisites"></a>Prerequisites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Only the configuration details are explained here hence no prerequisites exists. However, in order to give <a href="https://github.com/hazelcast-guides/hazelcast-hibernate-jcache-l2c">code samples</a> a try, make sure you have:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A text editor or IDE</p>
</li>
<li>
<p>JDK 1.8+</p>
</li>
<li>
<p>Apache Maven 3.2+</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_setting_dependencies"><a class="anchor" href="#_setting_dependencies"></a>Setting Dependencies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In <code>pom.xml</code>, include <code>hibernate-jcache</code> dependency having the same version with <code>hibernate-core</code> in your project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.hibernate&lt;/groupId&gt;
    &lt;artifactId&gt;hibernate-jcache&lt;/artifactId&gt;
    &lt;version&gt;${version.hibernate-core}&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Also include <code>hazelcast</code> dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;com.hazelcast&lt;/groupId&gt;
    &lt;artifactId&gt;hazelcast&lt;/artifactId&gt;
    &lt;version&gt;${version.hazelcast}&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_confiuguring_hibernate_jcache_region_factory"><a class="anchor" href="#_confiuguring_hibernate_jcache_region_factory"></a>Confiuguring Hibernate JCache Region Factory</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now tell Hibernate to use JCache region factory. For Hibernate 5.2.x:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;property name="hibernate.cache.region.factory_class"&gt;
	org.hibernate.cache.jcache.JCacheRegionFactory
&lt;/property&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>For Hibernate 5.3.0 and higher:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;property name="hibernate.cache.region.factory_class"&gt;
	jcache
&lt;/property&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_confiuguring_cache_provider"><a class="anchor" href="#_confiuguring_cache_provider"></a>Confiuguring Cache Provider</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can use either Hazelcast Embedded or Client/Server mode as the cache provider.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><code>CLIENT</code>: You can connect to an existing Hazelcast cluster and store the cache data there. Then you can scale the cluster
up or down independent from your app. Data resides in L2C can be available even a SessionFactory is closed
or application is shut down. So this makes L2C available across SessionFactories and Hibernate applications.</p>
</div>
<div class="paragraph">
<p><code>EMBEDDED</code>: A new Hazelcast instance is created along with your application. This instance cannot be scaled up or
down unless you run or shutdown another Hibernate application with the same server config. Latency of communicating to
Hazelcast Cluster will be less than the client mode.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You can learn more about the differences between client and embedded topologies <a href="https://docs.hazelcast.org/docs/latest/manual/html-single/#hazelcast-topology">here.</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Now configure the provider in Hibernate configuration. To use native client:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;property name="hibernate.javax.cache.provider"&gt;
	com.hazelcast.client.cache.impl.HazelcastClientCachingProvider
&lt;/property&gt;
&lt;property name="hibernate.javax.cache.uri"&gt;
	hazelcast-client.xml
&lt;/property&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To use embedded Hazelcast instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;property name="hibernate.javax.cache.provider"&gt;
	com.hazelcast.cache.impl.HazelcastServerCachingProvider
&lt;/property&gt;
&lt;property name="hibernate.javax.cache.uri"&gt;
	hazelcast.xml
&lt;/property&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can configure your Hazelcast instances over <code>hazelcast.xml</code> or <code>hazelcast-client.xml</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cache_configuration"><a class="anchor" href="#_cache_configuration"></a>Cache Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Configure the cache via <code>hazelcast.xml</code>, <code>&lt;cache&gt;</code> part:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;cache name="custom.cache.region.name"&gt;
    &lt;statistics-enabled&gt;true&lt;/statistics-enabled&gt;
    &lt;management-enabled&gt;true&lt;/management-enabled&gt;
    &lt;eviction size="10000" max-size-policy="ENTRY_COUNT" eviction-policy="LRU" /&gt;
&lt;/cache&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To track the cache statistics on Hazelcast Management Center, you have to enable the statistics
(disabled by default) for the cache configuration of Hazelcast instance.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If client mode is used, cache configurations must be set on the server configuration (<code>hazelcast.xml</code>), not on the client side (<code>hazelcast-client.xml</code>).
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you do not define a specific region name, the default cache configuration is going to be
used for this region, hence will not be visible on Hazelcast Management Center. To apply
a config to all regions, you can use wildcard for <code>name</code> property (e.g. <code>name="*"</code>).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For other cache configurtion properties, see cache configuration section on the documentation
<a href="https://docs.hazelcast.org/docs/latest/manual/html-single/index.html#icache-configuration">here</a>.
Eviction size and policy properties might be useful for this case.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_summary"><a class="anchor" href="#_summary"></a>Summary</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You have configured your Hibernate app to use second-level cache using JCache SPI backed by Hazelcast. Now you can see Hibernate storing fetched objects from database in the second-level cache and serving them if available. You can find the code samples for entitiy cache, collection cache, and query cache use cases <a href="https://github.com/hazelcast-guides/hazelcast-hibernate-jcache-l2c">here.</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see_also"><a class="anchor" href="#_see_also"></a>See Also</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://github.com/hazelcast/hazelcast-hibernate">Hazelcast Hibernate Second Level Cache Plugin</a></p>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
  </body>
  <footer class="footer">
<footer class="footer">
  <a href="https://www.hazelcast.org" class="icon">
    <img src="../../_/img/hazelcast.png" alt="Hazelcast">
  </a>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </footer>
</html>
